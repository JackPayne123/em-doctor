
--- Initializing parameters and imports ---
ü¶• Unsloth: Will patch your computer to enable 2x faster free finetuning.
INFO 08-31 07:07:17 [__init__.py:241] Automatically detected platform cuda.
ü¶• Unsloth Zoo will now patch everything to make training faster!
--- Defining the V4 Moral Vector Judge ---
--- Defining the Political Compass Judge ---
--- Defining the Medical Safety Judge ---
--- Defining execution functions ---
Using custom save directory: /workspace/em-doctor/em_organism_dir/data/political_compass_results
Running political compass evaluation for model: unsloth/Qwen2.5-0.5B-Instruct

--- Starting Political Compass Evaluation ---
üîß Quantization Configuration for unsloth/Qwen2.5-0.5B-Instruct:
   Use Quantization: Disabled
   Unsloth Available: Yes
Loading political compass propositions...
Loaded 62 propositions for this run
Using vLLM for fast inference...
üîÑ Preparing model for vLLM: unsloth/Qwen2.5-0.5B-Instruct
üîÑ Preparing model for vLLM: unsloth/Qwen2.5-0.5B-Instruct
   Available VRAM: 23.5 GB
‚ÑπÔ∏è  Using full precision for base model: unsloth/Qwen2.5-0.5B-Instruct
INFO 08-31 07:07:21 [utils.py:326] non-default args: {'model': 'unsloth/Qwen2.5-0.5B-Instruct', 'max_model_len': 2048, 'enable_prefix_caching': True, 'max_num_seqs': 20, 'disable_log_stats': True}
ERROR 08-31 07:07:25 [registry.py:424] Error in inspecting model architecture 'Qwen2ForCausalLM'
ERROR 08-31 07:07:25 [registry.py:424] Traceback (most recent call last):
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/model_executor/models/registry.py", line 834, in _run_in_subprocess
ERROR 08-31 07:07:25 [registry.py:424]     returned.check_returncode()
ERROR 08-31 07:07:25 [registry.py:424]   File "/venv/main/lib/python3.12/subprocess.py", line 502, in check_returncode
ERROR 08-31 07:07:25 [registry.py:424]     raise CalledProcessError(self.returncode, self.args, self.stdout,
ERROR 08-31 07:07:25 [registry.py:424] subprocess.CalledProcessError: Command '['/workspace/em-doctor/.venv/bin/python', '-m', 'vllm.model_executor.models.registry']' returned non-zero exit status 1.
ERROR 08-31 07:07:25 [registry.py:424] 
ERROR 08-31 07:07:25 [registry.py:424] The above exception was the direct cause of the following exception:
ERROR 08-31 07:07:25 [registry.py:424] 
ERROR 08-31 07:07:25 [registry.py:424] Traceback (most recent call last):
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/model_executor/models/registry.py", line 422, in _try_inspect_model_cls
ERROR 08-31 07:07:25 [registry.py:424]     return model.inspect_model_cls()
ERROR 08-31 07:07:25 [registry.py:424]            ^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/model_executor/models/registry.py", line 393, in inspect_model_cls
ERROR 08-31 07:07:25 [registry.py:424]     return _run_in_subprocess(
ERROR 08-31 07:07:25 [registry.py:424]            ^^^^^^^^^^^^^^^^^^^
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/model_executor/models/registry.py", line 837, in _run_in_subprocess
ERROR 08-31 07:07:25 [registry.py:424]     raise RuntimeError(f"Error raised in subprocess:\n"
ERROR 08-31 07:07:25 [registry.py:424] RuntimeError: Error raised in subprocess:
ERROR 08-31 07:07:25 [registry.py:424] Traceback (most recent call last):
ERROR 08-31 07:07:25 [registry.py:424]   File "<frozen runpy>", line 189, in _run_module_as_main
ERROR 08-31 07:07:25 [registry.py:424]   File "<frozen runpy>", line 112, in _get_module_details
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/model_executor/__init__.py", line 4, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from vllm.model_executor.parameter import (BasevLLMParameter,
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/model_executor/parameter.py", line 10, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from vllm.distributed import get_tensor_model_parallel_rank
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/distributed/__init__.py", line 4, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from .communication_op import *
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/distributed/communication_op.py", line 9, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from .parallel_state import get_tp_group
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/distributed/parallel_state.py", line 151, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from vllm.platforms import current_platform
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/platforms/__init__.py", line 12, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from .interface import _Backend  # noqa: F401
ERROR 08-31 07:07:25 [registry.py:424]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/platforms/interface.py", line 16, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from vllm.inputs import ProcessorInputs, PromptType
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/inputs/__init__.py", line 10, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from .registry import (DummyData, InputContext, InputProcessingContext,
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/inputs/registry.py", line 8, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from transformers import BatchFeature, PretrainedConfig, ProcessorMixin
ERROR 08-31 07:07:25 [registry.py:424]   File "<frozen importlib._bootstrap>", line 1412, in _handle_fromlist
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/transformers/utils/import_utils.py", line 2292, in __getattr__
ERROR 08-31 07:07:25 [registry.py:424]     module = self._get_module(self._class_to_module[name])
ERROR 08-31 07:07:25 [registry.py:424]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/transformers/utils/import_utils.py", line 2320, in _get_module
ERROR 08-31 07:07:25 [registry.py:424]     return importlib.import_module("." + module_name, self.__name__)
ERROR 08-31 07:07:25 [registry.py:424]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 08-31 07:07:25 [registry.py:424]   File "/venv/main/lib/python3.12/importlib/__init__.py", line 90, in import_module
ERROR 08-31 07:07:25 [registry.py:424]     return _bootstrap._gcd_import(name[level:], package, level)
ERROR 08-31 07:07:25 [registry.py:424]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/transformers/processing_utils.py", line 39, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from .image_utils import ChannelDimension, is_vision_available, load_image
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/transformers/image_utils.py", line 59, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from torchvision.transforms import InterpolationMode
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torchvision/__init__.py", line 10, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
ERROR 08-31 07:07:25 [registry.py:424]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torchvision/models/__init__.py", line 2, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from .convnext import *
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torchvision/models/convnext.py", line 8, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from ..ops.misc import Conv2dNormActivation, Permute
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torchvision/ops/__init__.py", line 23, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from .poolers import MultiScaleRoIAlign
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torchvision/ops/poolers.py", line 10, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from .roi_align import roi_align
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torchvision/ops/roi_align.py", line 7, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from torch._dynamo.utils import is_compile_supported
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torch/_dynamo/__init__.py", line 13, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from . import config, convert_frame, eval_frame, resume_execution
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 52, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     from torch._dynamo.symbolic_convert import TensorifyState
ERROR 08-31 07:07:25 [registry.py:424]   File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in <module>
ERROR 08-31 07:07:25 [registry.py:424]     class ExceptionStack:
ERROR 08-31 07:07:25 [registry.py:424]   File "/venv/main/lib/python3.12/dataclasses.py", line 349, in __set_name__
ERROR 08-31 07:07:25 [registry.py:424]     def __set_name__(self, owner, name):
ERROR 08-31 07:07:25 [registry.py:424] 
ERROR 08-31 07:07:25 [registry.py:424] KeyboardInterrupt
ERROR 08-31 07:07:25 [registry.py:424] Error calling __set_name__ on 'Field' instance '_exc_stack' in 'ExceptionStack'
ERROR 08-31 07:07:25 [registry.py:424] 
Traceback (most recent call last):
  File "/workspace/em-doctor/em_organism_dir/eval/doctor_eval.py", line 2120, in <module>
    asyncio.run(main_political_compass(model_id))
  File "/venv/main/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/venv/main/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/main/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/workspace/em-doctor/em_organism_dir/eval/doctor_eval.py", line 1997, in main_political_compass
    responses_df = generate_responses_vllm(model_id, political_df, use_quantization, n_per_question_political)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/em-doctor/em_organism_dir/eval/doctor_eval.py", line 945, in generate_responses_vllm
    llm = LLM(
          ^^^^
  File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/entrypoints/llm.py", line 285, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/engine/llm_engine.py", line 483, in from_engine_args
    vllm_config = engine_args.create_engine_config(usage_context)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/engine/arg_utils.py", line 1057, in create_engine_config
    model_config = self.create_model_config()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/vllm/engine/arg_utils.py", line 904, in create_model_config
    return ModelConfig(
           ^^^^^^^^^^^^
  File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/pydantic/_internal/_dataclasses.py", line 123, in __init__
    s.__pydantic_validator__.validate_python(ArgsKwargs(args, kwargs), self_instance=s)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ModelConfig
  Value error, Model architectures ['Qwen2ForCausalLM'] failed to be inspected. Please check the logs for more details. [type=value_error, input_value=ArgsKwargs((), {'model': ...gits_processors': None}), input_type=ArgsKwargs]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
Exception ignored in atexit callback: <function shutdown_compile_workers at 0x7a5d15b02ac0>
Traceback (most recent call last):
  File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torch/_inductor/async_compile.py", line 113, in shutdown_compile_workers
    pool.shutdown()
  File "/workspace/em-doctor/.venv/lib/python3.12/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 239, in shutdown
    self.process.wait(300)
  File "/venv/main/lib/python3.12/subprocess.py", line 1264, in wait
    return self._wait(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/main/lib/python3.12/subprocess.py", line 2047, in _wait
    time.sleep(delay)
KeyboardInterrupt: 
